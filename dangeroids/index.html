<!DOCTYPE HTML>
<html>
<head>
	<title>pixi.js example 1</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			background-color: #000000;
		}
	</style>
	<script src="pixi.js"></script>
	<script src="planet.js"></script>
	<script src="../papaparse.min.js"></script>
</head>
<body>
	<!-- <iframe id="nasa_data" name="nasa_data" width="640" height="480" src="http://neo.jpl.nasa.gov/ca/"> -->
	</iframe>
	<script>

	// go and retrieve NASA data about Upcoming close approaches to earth
/*	$.ajax({
	url: "http://neo.jpl.nasa.gov/ca/",
	cache: false
	})
	.done(function( html ) {
		console.log(html);
	});*/

/*	$("#nasa_data").load(function() {
		console.log("iframe loaded");
		console.log($("#nasa_data").find("table").closest().html());
	});*/



	// initial positions
	var merR = 60;
	var merAlpha = 3.14;
	var merSize = 2;
	var venR = 80;
	var venAlpha = 1;
	var venSize = 4;
	var earR = 100;
	var earAlpha = 2;
	var earSize = 4;
	var marR = 120;
	var marAlpha = 0;
	var marSize = 3;
	var jupR = 200;
	var jupAlpha = -1;
	var jupSize = 10;
	var satR = 250;
	var satAlpha = -2;
	var satSize = 9;
	var uraR = 300;
	var uraAlpha = -3;
	var uraSize = 8;
	var nepR = 350;
	var nepAlpha = 0;
	var nepSize = 8;

	// center of the window
	var centerX = window.innerWidth/2;
	var centerY = window.innerHeight/2;
	
	// planets
	var sun = new Planet(0, 0, 0, 0xCCCCCC, 40, "Sun");
	var mercury = new Planet(merR, merAlpha, 0.01, 0xEEEEEE, merSize, "Mercury");
	var venus = new Planet(venR, venAlpha, 0.005, 0xEEEEAA, venSize, "Venus");
	var earth = new Planet(earR, earAlpha, 0.003, 0x0000FF, earSize, "Earth");
	var mars = new Planet(marR, marAlpha, 0.0025, 0xFF0000, marSize, "Mars");
	var jupiter = new Planet(jupR, jupAlpha, 0.001, 0xDEBD00, jupSize, "Jupiter");
	var saturn = new Planet(satR, satAlpha, 0.0006, 0xFFD991, satSize, "Saturn");
	var uranus = new Planet(uraR, uraAlpha, 0.0004, 0x69E6FF, uraSize, "Uranus");
	var neptune = new Planet(nepR, nepAlpha, 0.0001, 0x2977FF, nepSize, "Neptune");


	// create an new instance of a pixi stage
	stage = new PIXI.Stage(0x000000);

	// create a renderer instance
	var renderer = PIXI.autoDetectRenderer(window.innerWidth, window.innerHeight);

	// add the renderer view element to the DOM
	document.body.appendChild(renderer.view);

	requestAnimFrame(animate);

	// add Sun
	sun.draw(centerX, centerY);
	
	// add Mercury
	mercury.draw(centerX + merR*Math.cos(merAlpha), centerY - merR*Math.sin(merAlpha));

	// add Venus
	venus.draw(centerX + venR*Math.cos(venAlpha), centerY - venR*Math.sin(venAlpha));

	// add Earth
	earth.draw(centerX + earR*Math.cos(earAlpha), centerY - earR*Math.sin(earAlpha));

	// add Mars
	mars.draw(centerX + marR*Math.cos(marAlpha), centerY - marR*Math.sin(marAlpha));

	// add Jupiter
	jupiter.draw(centerX + jupR*Math.cos(jupAlpha), centerY - jupR*Math.sin(jupAlpha));

	// add Saturn
	saturn.draw(centerX + satR*Math.cos(satAlpha), centerY - satR*Math.sin(satAlpha));

	// add Uranus
	uranus.draw(centerX + uraR*Math.cos(uraAlpha), centerY - uraR*Math.sin(uraAlpha));

	// add Neptune
	neptune.draw(centerX + nepR*Math.cos(nepAlpha), centerY - nepR*Math.sin(nepAlpha));

	function animate() {
	    requestAnimFrame(animate);
	    
	    // rotate mercury
	    rotate(mercury, mercury.r, merAlpha, mercury.angle, mercury.speed);
	    mercury.angle += mercury.speed;
	    mercury.updateTextPosition();

	    // rotate venus
	    rotate(venus, venus.r, venAlpha, venus.angle, venus.speed);
	    venus.angle += venus.speed;
	    venus.updateTextPosition();

	    // rotate earth
	    rotate(earth, earth.r, earAlpha, earth.angle, earth.speed);
	    earth.angle += earth.speed;
	    earth.updateTextPosition();

	    // rotate mars
	    rotate(mars, mars.r, marAlpha, mars.angle, mars.speed);
	    mars.angle += mars.speed;
	    mars.updateTextPosition();

	    // rotate jupiter
	    rotate(jupiter, jupiter.r, jupAlpha, jupiter.angle, jupiter.speed);
	    jupiter.angle += jupiter.speed;	    
	    jupiter.updateTextPosition();

	    // rotate saturn
	    rotate(saturn, saturn.r, satAlpha, saturn.angle, saturn.speed);
	    saturn.angle += saturn.speed;
	    saturn.updateTextPosition();

	    // rotate uranus
	    rotate(uranus, uranus.r, uraAlpha, uranus.angle, uranus.speed);
	    uranus.angle += uranus.speed;
	    uranus.updateTextPosition();

	    // rotate neptune
	    rotate(neptune, neptune.r, nepAlpha, neptune.angle, neptune.speed);
	    neptune.angle += neptune.speed;
	    neptune.updateTextPosition();

	    // render the stage
	    renderer.render(stage);
	}

	function rotate(object, r, initAlpha, alpha, speed)
	{
		object.x = -object.centerX + centerX + r*Math.cos(alpha);
		object.y = -object.centerY + centerY + r*Math.sin(alpha);
	}

	</script>

	</body>
</html>